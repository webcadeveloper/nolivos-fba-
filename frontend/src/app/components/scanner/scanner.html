<div class="scanner-container">
  <div class="header">
    <h1>Configurar Escaneo</h1>
    <p>Personaliza los par√°metros del escaneo autom√°tico</p>
  </div>

  @if (error) {
    <div class="error">{{ error }}</div>
  }

  @if (scanRunning) {
    <div class="scanning-alert">
      <div class="scanning-icon">üîÑ</div>
      <div class="scanning-content">
        <h3>Escaneo en Progreso</h3>
        <p>El sistema est√° buscando nuevas oportunidades...</p>
        <div class="progress-info">
          <div class="progress-stat">
            <span class="label">Productos Escaneados:</span>
            <span class="value">{{ progress.products_scanned }} / {{ progress.total_products }}</span>
          </div>
          <div class="progress-stat">
            <span class="label">Oportunidades Encontradas:</span>
            <span class="value">{{ progress.opportunities_found }}</span>
          </div>
          <div class="progress-stat">
            <span class="label">Progreso:</span>
            <span class="value">{{ progress.progress_percent }}%</span>
          </div>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="progress.progress_percent"></div>
        </div>
      </div>
    </div>
  }

  <div class="config-section">
    <h2>Par√°metros de Escaneo</h2>
    
    <div class="config-grid">
      <div class="config-card">
        <div class="config-icon">üì¶</div>
        <div class="config-content">
          <label class="config-label">Productos por Categor√≠a</label>
          <input 
            type="number" 
            class="config-input" 
            [(ngModel)]="maxProducts" 
            min="1" 
            max="100"
            [disabled]="scanRunning">
          <p class="config-description">N√∫mero m√°ximo de productos a analizar por cada categor√≠a de Amazon</p>
        </div>
      </div>

      <div class="config-card">
        <div class="config-icon">‚ö°</div>
        <div class="config-content">
          <label class="config-label">Workers Paralelos</label>
          <input 
            type="number" 
            class="config-input" 
            [(ngModel)]="maxWorkers" 
            min="1" 
            max="50"
            [disabled]="scanRunning">
          <p class="config-description">N√∫mero de procesos paralelos para escanear m√°s r√°pido</p>
        </div>
      </div>
    </div>

    <div class="preset-buttons">
      <h3>Configuraciones Predefinidas</h3>
      <div class="preset-grid">
        <button class="preset-btn" (click)="setPreset('quick')" [disabled]="scanRunning">
          <div class="preset-icon">‚ö°</div>
          <div class="preset-name">Escaneo R√°pido</div>
          <div class="preset-desc">5 productos, 20 workers</div>
        </button>
        <button class="preset-btn" (click)="setPreset('balanced')" [disabled]="scanRunning">
          <div class="preset-icon">‚öñÔ∏è</div>
          <div class="preset-name">Balanceado</div>
          <div class="preset-desc">15 productos, 25 workers</div>
        </button>
        <button class="preset-btn" (click)="setPreset('deep')" [disabled]="scanRunning">
          <div class="preset-icon">üîç</div>
          <div class="preset-name">Escaneo Profundo</div>
          <div class="preset-desc">50 productos, 30 workers</div>
        </button>
      </div>
    </div>

    <div class="action-buttons">
      <button class="btn-start" (click)="startScan()" [disabled]="scanRunning">
        <span class="btn-icon">üöÄ</span>
        <span>Iniciar Escaneo</span>
      </button>
      <button class="btn-view-results" routerLink="/opportunities">
        <span class="btn-icon">üìä</span>
        <span>Ver Resultados</span>
      </button>
    </div>
  </div>

  @if (logs.length > 0) {
    <div class="logs-section">
      <h2>Registro de Actividad</h2>
      <div class="logs-container">
        @for (log of logs; track $index) {
          <div class="log-entry">{{ log }}</div>
        }
      </div>
      <button class="btn-refresh-logs" (click)="refreshLogs()">
        üîÑ Actualizar Logs
      </button>
    </div>
  }

  <div class="info-section">
    <h2>Informaci√≥n</h2>
    <div class="info-grid">
      <div class="info-card">
        <div class="info-icon">‚ÑπÔ∏è</div>
        <div class="info-content">
          <h3>Productos por Categor√≠a</h3>
          <p>M√°s productos = m√°s oportunidades encontradas, pero el escaneo tardar√° m√°s tiempo.</p>
        </div>
      </div>
      <div class="info-card">
        <div class="info-icon">‚ö°</div>
        <div class="info-content">
          <h3>Workers Paralelos</h3>
          <p>M√°s workers = escaneo m√°s r√°pido, pero consume m√°s recursos del sistema.</p>
        </div>
      </div>
      <div class="info-card">
        <div class="info-icon">üéØ</div>
        <div class="info-content">
          <h3>Recomendaci√≥n</h3>
          <p>Para uso diario, usa el escaneo balanceado. Para b√∫squedas r√°pidas, usa el escaneo r√°pido.</p>
        </div>
      </div>
    </div>
  </div>
</div>
